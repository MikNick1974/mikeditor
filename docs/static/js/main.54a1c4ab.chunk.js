(this["webpackJsonpspace-haven-editor"]=this["webpackJsonpspace-haven-editor"]||[]).push([[1],{10:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return n}));const r="en-US",s="_locale",n=!0},19:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var r=a(1),s=a(50),n=a.n(s),i=a(47),c=a(23),l=a.n(c),o=a(10);var u=async e=>{const t=await e.text();return t?l.a.xml2js(t,{compact:o.b,alwaysArray:["c","ship","l","r","m","s","t","b","e"]}):null};var d=async e=>l.a.js2xml(e,{spaces:"\t",compact:o.b});var h=e=>{var t,a,r;if(!(null===e||void 0===e||null===(t=e.game)||void 0===t?void 0:t.ships))return null;const{game:{ships:s,crafts:n,research:i,playerBank:c}}=e,l={};var o,u;((null===s||void 0===s?void 0:s.ship)&&(l.ships=s.ship.map((e=>{var t,a,r;const s={};return s.name=e._attributes.sname,s.id=e._attributes.sid,s.tiles=e.e,s.dimensions={x:parseInt(e._attributes.sx,10),y:parseInt(e._attributes.sy,10)},s.characters=(null===(t=e.characters)||void 0===t?void 0:t.c)||[],s.monsters=(null===(a=e.characters)||void 0===a?void 0:a.m)||[],s.robots=(null===(r=e.characters)||void 0===r?void 0:r.r)||[],s}))),(null===n||void 0===n?void 0:n.c)&&(l.crafts=n.c.map((e=>{var t,a;const r={};return r.id=e._attributes.id,r.name=e._attributes.cname||null,r.characters=(null===(t=e.characters)||void 0===t?void 0:t.c)||[],r.robots=(null===(a=e.characters)||void 0===a?void 0:a.r)||[],r}))),null===i||void 0===i||null===(a=i.states)||void 0===a?void 0:a.l)&&(l.research={states:i.states.l,tree:null===(o=i._attributes)||void 0===o?void 0:o.treeId,active:null===(u=i._attributes)||void 0===u?void 0:u.activeResearchId});return l.bank={credits:null===c||void 0===c||null===(r=c._attributes)||void 0===r?void 0:r.ca},l};var b=(e,t)=>{if(!t.ships||!t.crafts||!t.research||!t.bank)return null;const a=JSON.parse(JSON.stringify(e));return a.game.ships.ship.forEach((e=>{const a=t.ships.find((t=>t.id===e._attributes.sid));e._attributes.sname=a.name,e.characters.c=a.characters})),a.game.crafts.c.forEach((e=>{const a=t.crafts.find((t=>t.id===e._attributes.id));e._attributes.cname&&(e._attributes.cname=a.name),e.characters&&(e.characters.c=a.characters)})),a.game.research.states.l.forEach((e=>{e=t.research.states[e._attributes.techId]})),a.game.research._attributes.activeResearchId=t.research.active,a.game.research._attributes.treeId=t.research.tree,a.game.playerBank._attributes.ca=t.bank.credits,a},p=a(2);const v=Object(r.createContext)(null),j=()=>({}),m=(e,t)=>e.ships.findIndex((e=>e.id===t)),_=(e,t,a)=>{var r;return null===(r=e.ships[t])||void 0===r?void 0:r.characters.findIndex((e=>e._attributes.name===a||e._attributes.entId===a))},f=(e,t)=>{const a=n()({proto:!1})(e),r={insert:()=>t.state,reset:()=>({}),plusResearch:()=>{const e=((e,t)=>e.research.states.findIndex((e=>e._attributes.techId===t)))(a,t.id);return a.research.states[e].blocksDone._attributes[t.level]=parseInt(a.research.states[e].blocksDone._attributes[t.level],10)+1,a},minusResearch:()=>(a.research.states[t.index].blocksDone._attributes[t.level]=parseInt(a.research.states[t.index].blocksDone._attributes[t.level],10)+1,a),setResearch:()=>(a.research.states[t.id].blocksDone._attributes[t.level]=t.value,a),setCredits:()=>(a.bank.credits=t.value,a),setShipName:()=>{const e=a.ships.findIndex((e=>e.name===t.name));return e>=0&&(a.ships[e].name=t.value),a},setSuited:()=>{const e=m(a,t.ship),r=_(a,e,t.name);if(e>=0&&r>=0)return t.value?a.ships[e].characters[r]._attributes.is="1":a.ships[e].characters[r]._attributes.is&&delete a.ships[e].characters[r]._attributes.is,a},removeCondition:()=>{var e;const r=m(a,t.ship),s=_(a,r,t.name),n=null===(e=a.ships[r])||void 0===e?void 0:e.characters[s].pers.conditions.c.findIndex((e=>e._attributes.id===t.condition));var i;if(r>=0&&s>=0&&n>=0)return null===(i=a.ships[r])||void 0===i||i.characters[s].pers.conditions.c.splice(n,1),a},setStorageElement:()=>{const e=m(a,t.ship),r=((e,t,a,r)=>{var s;return null===(s=e.ships[t])||void 0===s?void 0:s.tiles.findIndex((e=>e.l&&e._attributes.x===a&&e._attributes.y===r))})(a,e,t.x,t.y),s=((e,t,a,r)=>{var s;return null===(s=e.ships[t])||void 0===s?void 0:s.tiles[a].l[3].feat.inv.s.findIndex((e=>e._attributes.elementaryId===r))})(a,e,r,t.element);return e>=0&&r>=0&&s>=0&&(a.ships[e].tiles[r].l[3].feat.inv.s[s]._attributes.inStorage=t.count),a}};if(!r[t.type])throw new Error("No such action in editGameData reducer");return r[t.type]()};t.b=({children:e})=>{const[t,a]=Object(r.useState)(null),[s,n]=Object(r.useState)(null),[c,l]=Object(r.useReducer)(f,{},j);return Object(p.jsx)(v.Provider,{value:{gameData:c,editGameData:l,gameFile:s,saveData:t,insertSaveData:async e=>{a(e);const t=e;if(t){const e=await u(t);0,n(e),l({type:"insert",state:h(e)})}},retrieveGameData:async()=>{const e=b(s,c),a=await d(e),r=new File([a],"game"),n=t.handle;await Object(i.b)(r,{fileName:"game"},n)},reset:()=>{a(null),n(null),l({type:"reset"})}},children:e})}},33:function(e,t,a){e.exports={heading:"heading_heading__2i3Kf",noFont:"heading_noFont__3Lj4O"}},34:function(e,t,a){e.exports={wrapper:"github_wrapper__2LYNf",logo:"github_logo__1ic0a"}},38:function(e,t,a){"use strict";var r=a(37),s=a(33),n=a.n(s),i=a(2);t.a=({level:e=1,noFont:t=!1,children:a,...s})=>{const c=`h${e>=1||e<=6?e:1}`;return Object(i.jsx)(c,{className:Object(r.a)(n.a.heading,(t||e>2)&&n.a.noFont),...s,children:a})}},49:function(e){e.exports=JSON.parse('{"change":[{"type":0,"value":"Change"}],"created_by":[{"type":0,"value":"Created by"}],"credits_monetary":[{"type":0,"value":"Credits"}],"crew":[{"type":0,"value":"Crew"}],"discard":[{"type":0,"value":"Discard"}],"disclaimer":[{"type":0,"value":"Disclaimer"}],"download":[{"type":0,"value":"Download"}],"edit_expl":[{"type":0,"value":"Edit what you want, and return here to download the file again"}],"energy":[{"type":0,"value":"Energy"}],"error_unknown":[{"type":0,"value":"Something went wrong"}],"gender_female":[{"type":0,"value":"Female"}],"gender_male":[{"type":0,"value":"Male"}],"general_edits":[{"type":0,"value":"General edits"}],"health":[{"type":0,"value":"Health"}],"home":[{"type":0,"value":"Home"}],"hunger":[{"type":0,"value":"Hunger"}],"in_suit":[{"type":0,"value":"in spacesuit"}],"loading_dots":[{"type":0,"value":"Loading..."}],"open_save":[{"type":0,"value":"Open Save"}],"research":[{"type":0,"value":"Research"}],"reset":[{"type":0,"value":"Reset"}],"ships":[{"type":0,"value":"Ships"}],"source_code":[{"type":0,"value":"Source Code on GitHub"}],"title":[{"type":0,"value":"Space Haven Editor"}],"upload_file":[{"type":0,"value":"Upload save file"}],"view_references":[{"type":0,"value":"View reference charts"}],"welcome":[{"type":0,"value":"Welcome!"}],"welcome_comm":[{"type":0,"value":"Welcome commander!"}]}')},51:function(e,t,a){e.exports={wrapper:"header_wrapper__qgCxK"}},53:function(e,t,a){e.exports={wrapper:"footer_wrapper__1C--_"}},54:function(e,t,a){e.exports={wrapper:"layout_wrapper__ixEjb"}},61:function(e,t,a){},66:function(e,t){},68:function(e,t){},84:function(e,t,a){"use strict";a.r(t);var r=a(1),s=a.n(r),n=a(48),i=a.n(n),c=(a(61),a(88)),l=a(4),o=a(16);var u={"en-US":a(49)},d=a(10),h=a(19),b=a(2);var p=({element:e,fallback:t})=>{const{gameData:a}=Object(r.useContext)(h.a);return t||(t=Object(b.jsx)(l.a,{to:"/"})),a.ships?e:t},v=a(87),j=a(38),m=a(51),_=a.n(m),f=a(52),g=a(34),x=a.n(g);var y=()=>{const{formatMessage:e}=Object(f.a)();return Object(b.jsx)("div",{className:x.a.wrapper,children:Object(b.jsx)("a",{href:"https://github.com/MoltenCoffee/space-haven-editor",rel:"noreferrer noopener",target:"_blank",children:Object(b.jsx)("img",{className:x.a.logo,src:"github64.png",alt:e({id:"source_code",defaultMessage:"Source Code on GitHub"})})})})};var O=()=>Object(b.jsxs)("header",{className:_.a.wrapper,children:[Object(b.jsx)(j.a,{children:Object(b.jsx)(o.c,{to:"/",children:Object(b.jsx)(v.a,{id:"title",defaultMessage:"Space Haven Editor"})})}),Object(b.jsx)(y,{})]}),w=a(53),S=a.n(w);var I=()=>Object(b.jsxs)("footer",{className:S.a.wrapper,children:[Object(b.jsx)(v.a,{id:"created_by",defaultMessage:"Created by"}),"\xa0",Object(b.jsx)("a",{href:"https://github.com/MoltenCoffee",rel:"noreferrer noopener",target:"_blank",children:"@MoltenCoffee"})]}),k=a(54),C=a.n(k);var D=({children:e})=>Object(b.jsx)("div",{className:C.a.wrapper,children:e});const E=Object(r.lazy)((()=>Promise.all([a.e(0),a.e(6)]).then(a.bind(null,614)))),N=Object(r.lazy)((()=>Promise.all([a.e(0),a.e(9)]).then(a.bind(null,599)))),F=Object(r.lazy)((()=>Promise.all([a.e(0),a.e(5)]).then(a.bind(null,612)))),M=Object(r.lazy)((()=>Promise.all([a.e(0),a.e(8)]).then(a.bind(null,613)))),P=Object(r.lazy)((()=>Promise.all([a.e(0),a.e(4)]).then(a.bind(null,610)))),L=Object(r.lazy)((()=>Promise.all([a.e(0),a.e(7)]).then(a.bind(null,611)))),R=()=>Object(b.jsx)(r.Suspense,{fallback:Object(b.jsx)("div",{children:"Loading..."}),children:Object(b.jsxs)(l.d,{children:[Object(b.jsx)(l.b,{path:"/",element:Object(b.jsx)(N,{})}),Object(b.jsx)(l.b,{path:"crew",element:Object(b.jsx)(F,{})}),Object(b.jsx)(l.b,{path:"research",element:Object(b.jsx)(M,{})}),Object(b.jsx)(l.b,{path:"ships",element:Object(b.jsx)(P,{})})]})});var H=()=>{const[e,t]=Object(r.useState)(localStorage.getItem(d.c)||null);return Object(r.useEffect)((()=>{document.getElementById("initialTitle").remove()}),[]),Object(b.jsx)(c.a,{messages:u,locale:e||d.a,defaultLocale:d.a,children:Object(b.jsx)(h.b,{children:Object(b.jsx)(o.a,{children:Object(b.jsxs)(D,{children:[Object(b.jsx)(O,{}),Object(b.jsxs)(l.d,{children:[Object(b.jsx)(l.b,{path:"/",element:Object(b.jsx)(E,{})}),Object(b.jsx)(l.b,{path:"/reference",element:Object(b.jsx)(L,{})}),Object(b.jsx)(p,{path:"edit/*",element:Object(b.jsx)(R,{})})]}),Object(b.jsx)(I,{})]})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var z=e=>{e&&e instanceof Function&&a.e(19).then(a.bind(null,609)).then((({getCLS:t,getFID:a,getFCP:r,getLCP:s,getTTFB:n})=>{t(e),a(e),r(e),s(e),n(e)}))};var B=function({name:e,delta:t,id:a}){gtag("event",e,{event_category:"Web Vitals",event_label:a,value:Math.round("CLS"===e?1e3*t:t),non_interaction:!0})};i.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(H,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()})).catch((e=>{console.error(e.message)})),z(B)}},[[84,2,3]]]);
//# sourceMappingURL=main.54a1c4ab.chunk.js.map